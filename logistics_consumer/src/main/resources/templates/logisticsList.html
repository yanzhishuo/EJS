<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>管理物流信息</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/style1.css}"/>
    <link rel="stylesheet" type="text/css" th:href="@{/css/shopping-mall-index.css}"/>
    <script type="text/javascript" th:src="@{/js/jquery.js}"></script>
    <script type="text/javascript" th:src="@{/js/zhonglin.js}"></script>
</head>

<body>
EJS物流
<div class="top">
    <div class="top-con w1200">
        <p class="t-con-l f-l">厚德载物,尽心服务</p>
        <ul class="t-con-r f-r">
            <li><a href="#">我 (员工中心)</a></li>
            <li><a href="#">工作记录</a></li>
            <li><a href="#">我的订单</a></li>
            <li class="erweima">
                <a href="#">分享二维码</a>
                <div class="ewm-tu">
                    <a href="#"><img th:src="@{/images/erweima-tu.jpg}"/></a>
                </div>
            </li>
            <li><a href="/login">退出</a></li>
            <div style="clear:both;"></div>
        </ul>
        <div style="clear:both;"></div>
    </div>
</div>

        <div class="man-info">
            <div class="man-if-con" >
                <div class="man-tit" >
                    <p class="p1">物流编号</p>
                    <p class="p2">物流状态</p>
                    <p class="p3">开始时间</p>
                    <p class="p4">最近更新时间</p>
                    <p class="p5">操作</p>
                </div >
                <ul id="wl" class="man-ul1">
                </ul>
            </div>
        </div>
    </div>
    <div style="clear:both;"></div>
    </div>
<div class="logo f-l">
    <h1 align="center"><a href="#" title="中林网站"><img th:src="@{/images/ejs.jpg}"/></a></h1>
</div>
<div class="ft-service">
    <div class="w1200">
        <div class="sv-con-l2 f-l">
            <dl>
                <dt><a href="#">新手上路</a></dt>
                <dd>
                    <a href="#">物流配送流程</a>
                    <a href="#">收款教程</a>
                </dd>
            </dl>
            <dl>
                <dt><a href="#">配送方式</a></dt>
                <dd>
                    <a href="#">货到付款区域</a>
                    <a href="#">配送费标准</a>
                </dd>
            </dl>
            <dl>
                <dt><a href="#">配送指南</a></dt>
                <dd>
                    <a href="#">常见问题</a>
                    <a href="#">配送流程</a>
                </dd>
            </dl>
            <dl>
                <dt><a href="#">售后服务</a></dt>
                <dd>
                    <a href="#">配送服务保障</a>
                    <a href="#">退款说明</a>
                    <a href="#">快递运送总则</a>
                </dd>
            </dl>
            <dl>
                <dt><a href="#">关于EJS物流</a></dt>
                <dd>
                    <a href="#">投诉与建议</a>
                </dd>
            </dl>
            <div style="clear:both;"></div>
        </div>
        <div class="sv-con-r2 f-r">
            <p class="sv-r-tle">187-8660-5539</p>
            <p>周一至周五9:00-17:30</p>
            <p>（仅收市话费）</p>
            <a href="#" class="zxkf">负责人电话</a>
        </div>
        <div style="clear:both;"></div>
    </div>
</div>
<script type="text/javascript">

    //同步加载数据
    finish0();
    function finish0 () {
        $.ajax({
            async: false,
            url: '/logistics/list',
            dataType: 'json',
            success: function (data) {
                renderLogisticstHtml(data);

            }
        });
    }
    function finish (logisticsId) {
        $.ajax({
            async: false,
            url: '/logistics/finished',
            data: {"logisticsId": logisticsId},
            dataType: 'json',
            success: function (data) {
                renderLogisticstHtml(data);

            }
        });
    }
    function renderLogisticstHtml(data){
        // // window.location.href = "/logistics/finished?logisticsId=" + data;
        var logisticsHtml = "";//用来存储html内容
        //alert(data.length);
        if (data.length > 0) {
            $.each(data, function (v, o) {
                if (o.logisticsStatus != 0){
                    logisticsHtml += "<li>";
                    logisticsHtml += "<p  class='p1'>"+o.logisticsUuid+"</p>";
                    if (o.logisticsStatus == 3){
                        logisticsHtml += "<p  class='p2'>配送完成</p>";
                    }
                    if (o.logisticsStatus == 2){
                        logisticsHtml += "<p  class='p2'>配送中</p>";
                    }
                    logisticsHtml += "<p  class='p2'>"+o.logisticsCreateTime+"</p>";
                    logisticsHtml += "<p  class='p2'>"+o.logisticsUpdateTime+"</p>";
                    if (o.logisticsStatus == 2){
                        logisticsHtml += "<button class='md-l-btn1' onclick='finish("+o.logisticsId+")'>确认送达</button>";
                    }
                    if (o.logisticsStatus == 3){
                        logisticsHtml += "<p  class='p2'>已送达</p>";
                    }
                    logisticsHtml += "<div style='clear:both;'></div>";
                    logisticsHtml += "</li>";
                }
            });
            $("#wl").html(logisticsHtml);
        }
    }
</script>
</body>
</html>
